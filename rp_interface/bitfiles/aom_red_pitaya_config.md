## Red Pitaya based AOM Controller

Generates 1V output for controlling the trap, and simultaneously generates a feedback signal. The feedback signal is always positive and is subtracted from the trap signal to avoid saturation. Both signals can be toggled individually.
The resulting signal is sent to DAC 1.

At the same time as the signals are toggled, a trigger pulse is generated and set to GPIO pin DIO0_P.

Output signal 2 can be set to output a 1V version of the trigger pulse (and presumably delayed by 1 clock cycle) or to repeat the output of DAC 1. This is controlled via the AXI GPIO interface

Feedback signal:
The feedback signal is generated by squaring input A, mutliplying it by a 32-bit integer, then keeping only 14 MSB. The input A should aim to use as much of the dynamic range as possible.

Trap and feedback toggling:
The duration of trap and feedback toggling is set by two 32-bit values (one for each), in number of ADC clock cycles (125MHz / 4 = 31.25MHz). The trap and feedback control can be set to different switch times, but they are both triggered by the same trigger.

Trigger pulse:
The trigger pulse width is set by a 16-bit value

TODO: Add a master disable to the feedback
Note: Full FB gain (0xffffffff) leads to a FB signal of 0.5Vpp amplitude
Halving the FB gain (0x7fffffff) leads to a FB signal of 0.25Vpp amplitude

Addresses:
0x41200000 -> 32-bit value, n_cycles trap
0x41200008 -> 32-bit value, n_cycles feedback
0x41210000 -> 1-bit value, trigger. detects rising edge
0x41210008 -> 32-bit value, squarer gain
0x41220000 -> 16-bit value, n_cycles trigger
0x41220008 -> 4-bit value, MSB is a disable pin for FB control, 3LSBs output select for DAC2 (0-7, 0 for DAC 1, 1 for trigger)